import sys
import os
import xbmc

def platform():
    ret = {
        "arch": sys.maxsize > 2**32 and "x64" or "x86",
    }

    if xbmc.getCondVisibility("system.platform.android"):
        ret["os"] = "android"
        arch = os.uname()[4].lower()
        if arch.startswith('arm') or arch.startswith('aarch'):
            ret["arch"] = "arm"
    elif xbmc.getCondVisibility("system.platform.linux"):
        ret["os"] = "linux"
        arch = os.uname()[4].lower()
        if arch.startswith('arm') or arch.startswith('aarch'):
            ret["arch"] = "arm"
    elif xbmc.getCondVisibility("system.platform.xbox"):
        system_platform = "xbox"
        ret["arch"] = ""
    elif xbmc.getCondVisibility("system.platform.windows"):
        ret["os"] = "windows"
    elif xbmc.getCondVisibility("system.platform.osx") or xbmc.getCondVisibility("system.platform.ios"):
        ret["os"] = "darwin"

    return ret

PLATFORM = platform()
